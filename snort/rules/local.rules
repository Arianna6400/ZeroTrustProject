# —————————————————————————————————————————————————————————————————————
# ZTA – Regole generiche (unico PEP in 10.10.1.222, PDP in 10.10.1.111)
# ——————————————————————————————————————————————————————————————————————

# SCAN generici verso il PEP
alert tcp [10.10.1.0/24,10.10.2.0/24,10.10.3.0/24,10.10.4.0/24] any -> 10.10.1.222 ![80,443,21] (msg:"ZTA SCAN TCP verso PEP su porta non-standard"; flags:S; sid:3000001; rev:1; priority:2;)
alert udp [10.10.1.0/24,10.10.2.0/24,10.10.3.0/24,10.10.4.0/24] any -> 10.10.1.222 any (msg:"ZTA SCAN UDP verso PEP"; sid:3000002; rev:1; priority:2;)
alert icmp [10.10.1.0/24,10.10.2.0/24,10.10.3.0/24,10.10.4.0/24] any -> 10.10.1.222 any (msg:"ZTA SCAN ICMP verso PEP"; sid:3000003; rev:1; priority:2;)

# POST HTTP verso il PEP (potenzialmente violazione policy)
alert tcp [10.10.1.0/24,10.10.2.0/24,10.10.3.0/24,10.10.4.0/24] any -> 10.10.1.222 8002 (msg:"ZTA POLICY VIOLATION: POST verso PEP"; flow:to_server,established; content:"POST"; http_method; sid:3000010; rev:1; priority:1;)

# Accesso non autorizzato (es. SYN diretto) verso PDP
alert tcp [10.10.1.0/24,10.10.2.0/24,10.10.3.0/24,10.10.4.0/24] any -> 10.10.1.111 8001 (msg:"ZTA POLICY VIOLATION: accesso diretto al PDP"; flags:S; sid:3000011; rev:1; priority:1;)

# ———————————————————————————————————
# Regole di detection generiche
# ———————————————————————————————————

alert ip any any -> any any (msg:"[ZTA] Pacchetto IP rilevato"; sid:1000008; rev:1;)