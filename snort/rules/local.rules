# === [ZTA] Regole base di visibilitÃ  e debug ===
alert tcp any any -> any any (msg:"[ZTA] Traffico TCP generico"; sid:1000001; rev:1; priority:2;)
alert udp any any -> any any (msg:"[ZTA] Traffico UDP generico"; sid:1000007; rev:1; priority:2;)
alert ip any any -> any any (msg:"[ZTA] Pacchetto IP rilevato"; sid:1000008; rev:1; priority:2;)

# === [ZTA] Rilevamento traffico verso il PEP ===
alert tcp any any -> any 8002 (msg:"[ZTA] POST diretto al PEP"; content:"POST"; sid:1000002; rev:3; priority:1;)
alert tcp any any -> any 8002 (msg:"[ZTA] Connessione TCP verso PEP (8002)"; sid:1000999; rev:2;)

# === [ZTA] Rilevamento traffico verso Squid (se ancora presente per debug/log) ===
alert tcp any any -> any 3128 (msg:"[ZTA] Accesso a Squid (esplicito)"; sid:1000003; rev:1; priority:1;)
alert tcp any any -> any 3129 (msg:"[ZTA] Accesso a Squid (intercettato)"; sid:1000004; rev:1; priority:2;)
alert tcp any any -> any 3129 (msg:"[ZTA] POST al proxy intercettato"; content:"POST"; sid:1000012; rev:2; priority:1;)

# === [ZTA] Rilevamento DoS e scansioni sul PEP ===
alert tcp any any -> any 8002 (msg:"[ZTA] Possibile POST DoS su PEP"; content:"POST"; threshold:type both, track by_src, count 3, seconds 5; sid:1000005; rev:2; priority:1;)
alert tcp any any -> any 8002 (msg:"[ZTA] Possibile scansione SYN su 8002"; flags:S; threshold:type both, track by_src, count 5, seconds 10; sid:1000006; rev:1; priority:2;)

# === [ZTA] Rilevamento traffico outbound HTTP da Squid (solo in chiaro) ===
alert tcp any any -> any 80 (msg:"[ZTA] HTTP outbound via Squid"; content:"Host:"; sid:1000010; rev:1; priority:1;)
alert tcp any any -> any 80 (msg:"[ZTA] URI sensibile (Cartella Clinica)"; content:"Cartella.Clinica"; sid:1000011; rev:1; priority:1;)
