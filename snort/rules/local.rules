###############################################################################
# ZTA – Regole per subnet specifiche
###############################################################################

# ——————————————————————————————————————————————
# 1 - AZIENDALE
# ——————————————————————————————————————————————
alert tcp 10.10.1.0/24 any -> 10.10.1.222 ![80,443,21] (msg:"ZTA Aziendale SCAN TCP verso PEP non-standard"; flags:S; sid:3001001; rev:1; priority:2;)

alert udp 10.10.1.0/24 any -> 10.10.1.222 any (msg:"ZTA Aziendale SCAN UDP verso PEP"; sid:3001002; rev:1; priority:2;)

alert icmp 10.10.1.0/24 any -> 10.10.1.222 any (msg:"ZTA Aziendale SCAN ICMP verso PEP"; sid:3001003; rev:1; priority:2;)

alert tcp 10.10.1.0/24 any -> 10.10.1.222 8002 (msg:"ZTA Aziendale POLICY VIOLATION: POST verso PEP"; flow:to_server,established; content:"POST"; http_method; sid:3001010; rev:1; priority:1;)

alert tcp 10.10.1.0/24 any -> 10.10.1.111 8001 (msg:"ZTA Aziendale POLICY VIOLATION: SYN verso PDP"; flags:S; sid:3001011; rev:1; priority:1;)


# ——————————————————————————————————————————————
# 2 - VPN
# ——————————————————————————————————————————————
alert tcp 10.10.2.0/24 any -> 10.10.2.222 ![80,443,21] (msg:"ZTA VPN SCAN TCP verso PEP non-standard"; flags:S; sid:3002001; rev:1; priority:2;)

alert udp 10.10.2.0/24 any -> 10.10.2.222 any (msg:"ZTA VPN SCAN UDP verso PEP"; sid:3002002; rev:1; priority:2;)

alert icmp 10.10.2.0/24 any -> 10.10.2.222 any (msg:"ZTA VPN SCAN ICMP verso PEP"; sid:3002003; rev:1; priority:2;)

alert tcp 10.10.2.0/24 any -> 10.10.2.222 8002 (msg:"ZTA VPN POLICY VIOLATION: POST verso PEP"; flow:to_server,established; content:"POST"; http_method; sid:3002010; rev:1; priority:1;)

alert tcp 10.10.2.0/24 any -> 10.10.1.111 8001 (msg:"ZTA VPN POLICY VIOLATION: SYN verso PDP"; flags:S; sid:3002011; rev:1; priority:1;)


# ——————————————————————————————————————————————
# 3 - DOMESTICA
# ——————————————————————————————————————————————
alert tcp 10.10.3.0/24 any -> 10.10.3.222 ![80,443,21] (msg:"ZTA Domestica SCAN TCP verso PEP non-standard"; flags:S; sid:3003001; rev:1; priority:2;)

alert udp 10.10.3.0/24 any -> 10.10.3.222 any (msg:"ZTA Domestica SCAN UDP verso PEP"; sid:3003002; rev:1; priority:2;)

alert icmp 10.10.3.0/24 any -> 10.10.3.222 any (msg:"ZTA Domestica SCAN ICMP verso PEP"; sid:3003003; rev:1; priority:2;)

alert tcp 10.10.3.0/24 any -> 10.10.3.222 8002 (msg:"ZTA Domestica POLICY VIOLATION: POST verso PEP"; flow:to_server,established; content:"POST"; http_method; sid:3003010; rev:1; priority:1;)

alert tcp 10.10.3.0/24 any -> 10.10.1.111 8001 (msg:"ZTA Domestica POLICY VIOLATION: SYN verso PDP"; flags:S; sid:3003011; rev:1; priority:1;)


# ——————————————————————————————————————————————
# 4 - PUBBLICA
# ——————————————————————————————————————————————
alert tcp 10.10.4.0/24 any -> 10.10.4.222 ![80,443,21] (msg:"ZTA Pubblica SCAN TCP verso PEP non-standard"; flags:S; sid:3004001; rev:1; priority:2;)

alert udp 10.10.4.0/24 any -> 10.10.4.222 any (msg:"ZTA Pubblica SCAN UDP verso PEP"; sid:3004002; rev:1; priority:2;)

alert icmp 10.10.4.0/24 any -> 10.10.4.222 any (msg:"ZTA Pubblica SCAN ICMP verso PEP"; sid:3004003; rev:1; priority:2;)

alert tcp 10.10.4.0/24 any -> 10.10.4.222 8002 (msg:"ZTA Pubblica POLICY VIOLATION: POST verso PEP"; flow:to_server,established; content:"POST"; http_method; sid:3004010; rev:1; priority:1;)

alert tcp 10.10.4.0/24 any -> 10.10.1.111 8001 (msg:"ZTA Pubblica POLICY VIOLATION: SYN verso PDP"; flags:S; sid:3004011; rev:1; priority:1;)


###############################################################################
# Regole generiche di debug 
###############################################################################
# alert tcp any any -> any any (msg:"[ZTA] Traffico TCP generico"; sid:1000001; rev:1;)
# alert udp any any -> any any (msg:"[ZTA] Traffico UDP generico"; sid:1000007; rev:1;)
alert ip any any -> any any (msg:"[ZTA] Pacchetto IP rilevato"; sid:1000008; rev:1;)
