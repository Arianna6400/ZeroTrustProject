# Porta di ascolto del proxy
http_port 3128

# 1. Definizione ACL per sottoreti Docker
acl rete_aziendale src 10.10.1.0/24
acl rete_vpn src 10.10.2.0/24
acl rete_domestica src 10.10.3.0/24
acl rete_pubblica src 10.10.4.0/24

# 2. Consenti solo le reti fidate
http_access allow rete_aziendale
http_access allow rete_vpn
http_access allow rete_domestica

# 3. Nega tutto il resto (pubblica o sconosciuta)
http_access deny all

# 4. Cache e risorse
cache_mem 256 MB
maximum_object_size_in_memory 8 MB
maximum_object_size 128 MB

# 5. Log accessi
access_log /var/log/squid/access.log squid

# 6. Aggiunta header di rete (opzionale, per debug/analisi)
request_header_add X-Rete Aziendale rete_aziendale
request_header_add X-Rete VPN rete_vpn
request_header_add X-Rete Domestica rete_domestica

# 7. Inoltra tutto verso il PEP
cache_peer pep parent 8002 0 no-query no-digest
never_direct allow all
