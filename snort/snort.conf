# Impostazioni di base
var HOME_NET 172.21.0.44/24          # Rete locale (da monitorare)
var EXTERNAL_NET !$HOME_NET          # Tutto tranne la rete locale
var SMTP_PORTS [25,465,587]          # Porte per SMTP
var HTTP_PORTS [80,443]              # Porte per HTTP/HTTPS
var DNS_PORTS [53]                   # Porta per DNS

# Interfaccia di rete
config interface: eth0  # Sostituisci con l'interfaccia corretta

# Regole di prestazione
config detection: search-method ac-bnfa    # Per ottimizzare le prestazioni
config blocking-mode yes                   # In modalitÃ  IPS, blocca il traffico dannoso
config alert-backlog 1000                  # Mantieni una coda di allarmi

# Logging
output alert_fast: /var/log/snort/alert_fast.log      # Avvisi veloci
output alert_csv: /var/log/snort/alert.csv          # Avvisi in formato CSV
output log_tcpdump: /var/log/snort/tcpdump.log      # Log in formato TCPdump

# Includi regole
include $RULE_PATH/local.rules
include $RULE_PATH/community.rules   # Regole della community di Snort
include $RULE_PATH/emerging.rules    # Regole per minacce emergenti (es. Emerging Threats)

# Include regole per attacchi comuni (SQL Injection, DoS, ecc.)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"SQL Injection Attempt"; content:"union select"; classtype:web-application-attack; sid:1000001; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"Possible DDoS detected"; dsize:>1400; flow:to_server; sid:1000002; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"DNS request detected"; content:"www."; sid:1000003; rev:1;)

# Rilevamento per attacchi di tipo buffer overflow
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP Buffer Overflow Attempt"; content:"USER"; sid:1000004; rev:1;)

# Rilevamento di scansioni di rete (ad esempio, scansione SYN)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"Possible SYN Scan"; flags:S; flow:stateless; sid:1000005; rev:1;)

# Rilevamento di attacchi via vulnerabilitÃ  comuni
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"MS SMB Vulnerability Exploit"; content:"|45 00 00 00|"; sid:1000006; rev:1;)

# Esecuzione regole personalizzate per monitorare specifiche risorse/protocollo
alert ip $HOME_NET any -> $EXTERNAL_NET any (msg:"Suspicious Network Traffic Detected"; dsize:>1024; sid:1000007; rev:1;)
